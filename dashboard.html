<!DOCTYPE html>  <html lang="ko">    <head>    
  <meta charset="UTF-8">    
  <meta name="viewport" content="width=device-width,initial-scale=1.0">    
  <title>More Than Fitness - Dashboard</title>    
  <style>    
    *{box-sizing:border-box;margin:0;padding:0}    
    body{display:flex;flex-direction:column;height:100vh;font-family:'Poppins',sans-serif;background:#f5f0e8;overflow:hidden}    
    .topbar{position:fixed;top:0;left:0;right:0;height:50px;background:#f5f0e8;display:flex;align-items:center;justify-content:space-between;padding:0 15px;box-shadow:0 2px 4px rgba(0,0,0,0.1);z-index:1001}    
    .topbar h1{font-size:18px;color:#0d1b2a}    
    .hamburger,.logout-btn{background:none;border:none;cursor:pointer;font-size:20px;color:#0d1b2a}    
    .sidebar{position:fixed;top:50px;left:0;bottom:0;width:180px;background:#0d1b2a;color:#fff;padding:15px;transform:translateX(-100%);transition:transform .3s ease;z-index:1002}    
    .sidebar.active{transform:translateX(0)}    
    .sidebar button{background:none;border:none;color:#fff;width:100%;text-align:left;margin:8px 0;cursor:pointer;font-size:14px}    
    .main{margin-top:50px;flex:1;overflow-y:auto;padding:8px}    
    /* 모바일 뷰포트에서 테이블을 유연하게 축소 */  
@media (max-width: 768px) {  
  .schedule-wrapper table {  
    table-layout: fixed;      /* 칸 너비 고정 배분 */  
    width: 100%;              /* 컨테이너 폭에 딱 맞춤 */  
    min-width: unset;         /* 더 이상 강제 최소 너비 없음 */  
  }  
  .schedule-wrapper th,  
  .schedule-wrapper td {  
    word-wrap: break-word;    /* 글자가 넘칠 때 단어 단위로 줄 바꿈 */  
    white-space: normal;  
  }  
}  
    .today-lessons{background:#fff;padding:8px;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.1);margin-bottom:8px}    
    .today-lessons h2{font-size:16px;color:#0d1b2a;margin-bottom:4px}    
    .today-lessons ul {  
  padding-left: 16px;  
}  
.today-lessons li {  
  overflow-wrap: break-word; /* 단어 단위 줄 바꿈 허용 */  
  word-break: break-all;     /* 너무 긴 단어도 강제 줄 바꿈 */  
  margin-bottom: 4px;  
}  
    .section-title{margin:8px 0 4px;font-size:14px;color:#0d1b2a}    
    .schedule-wrapper{background:#fff;padding:8px;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.1);margin-bottom:16px;overflow-x:auto}    
    table{width:100%;min-width:600px;border-collapse:collapse;font-size:12px}    
    th,td{border:1px solid #ccc;padding:4px;text-align:center;position:relative}    
    th{background:#0d1b2a;color:#fff}    
    th:first-child{background:#0d3b5a;cursor:pointer}    
    .time-cell{background:#f1f1f1;cursor:pointer}    
    .current-time-line{position:absolute;left:0;right:0;height:2px;background:#FF3B30;animation:pulse 5s ease-in-out infinite}    
    @keyframes pulse{0%,100%{opacity:0.4}50%{opacity:1}}    
    .overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000}    
    .popup{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:16px;border-radius:6px;z-index:1001;width:260px;max-width:90%;max-height:80vh;overflow-y:auto}    
    .button-group{display:flex;justify-content:space-between;margin-top:8px}    
    .button-group button{width:48%;padding:6px;background:#f5f0e8;border:none;border-radius:4px;cursor:pointer}    
    .bottom-nav{display:flex;position:fixed;bottom:0;left:0;right:0;background:#0d1b2a;justify-content:space-around;padding:8px 0}    
    .bottom-nav button{background:none;border:none;color:#fff;font-size:14px;cursor:pointer}    
    .main{padding-bottom:60px}    
  </style>    
</head>    
<body>    
  <!-- 상단바 -->    
  <div class="topbar">    
    <button class="hamburger" id="hamburger">☰</button>    
    <h1>More Than Fitness</h1>    
    <button class="logout-btn" id="btnLogout">로그아웃</button>    
  </div>    <!-- 사이드바 -->    <div class="sidebar" id="sidebar">    
    <button>내 정보 관리</button>    
    <button>회원 관리</button>    
    <button>스케줄 관리</button>    
    <button>기록 관리</button>    
    <button>상품 구매</button>    
  </div>    <!-- 메인 컨텐츠 -->    <div class="main">    
    <!-- 오늘 레슨 -->    
    <div class="today-lessons">    
      <h2>오늘 다음 레슨</h2>    
      <ul id="todayLessonList"></ul>    
    </div>  <!-- 이번 주 스케줄 -->    
<div class="section-title" contenteditable>이번 주 스케줄</div>    
<div class="schedule-wrapper">    
  <table id="scheduleTableCurr">    
    <thead>    
      <tr>    
        <th id="headerCurr">시간</th>    
        <th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th><th>일</th>    
      </tr>    
    </thead>    
    <tbody></tbody>    
  </table>    
</div>    <!-- 다음 주 스케줄 -->    <div class="section-title">다음 주 스케줄</div>    
<div class="schedule-wrapper">    
  <table id="scheduleTableNext">    
    <thead>    
      <tr>    
        <th>시간</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th><th>일</th>    
      </tr>    
    </thead>    
    <tbody></tbody>    
  </table>    
</div>    <!-- 지난 주 스케줄 -->    <div class="section-title">지난 주 스케줄</div>    
<div class="schedule-wrapper">    
  <table id="scheduleTableLast">    
    <thead>    
      <tr>    
        <th>시간</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th><th>일</th>    
      </tr>    
    </thead>    
    <tbody></tbody>    
  </table>    
</div>    </div>    <!-- 오버레이 -->    <div class="overlay" id="overlay"></div>    <!-- 팝업: 전체 시간 범위 -->    <div class="popup" id="popupRange">    
    <h3>시간 범위 설정</h3>    
    <label>시작: <input type="time" id="rangeStart" value="06:00"></label><br>    
    <label>종료: <input type="time" id="rangeEnd"   value="22:00"></label>    
    <div class="button-group">    
      <button onclick="applyRangeCurr()">적용</button>    
      <button onclick="closePopup()">취소</button>    
    </div>    
  </div>    <!-- 팝업: 분 단위 -->    <div class="popup" id="popupMinute">    
    <h3>분 단위 설정</h3>    
    <select id="minuteSelect">    
      <option>00</option><option>10</option><option>20</option>    
      <option>30</option><option>40</option><option>50</option>    
    </select>    
    <div class="button-group">    
      <button onclick="saveMinute()">저장</button>    
      <button onclick="closePopup()">취소</button>    
    </div>    
  </div>    <!-- 팝업: 레슨 입력 -->    <div class="popup" id="popupLesson">    
    <h3>레슨 정보</h3>    
    <input id="nameInput"       placeholder="이름" style="width:100%;margin:8px 0;padding:6px" />    
    <input id="enrolledInput"   type="number" placeholder="참여" style="width:48%" />    
    <input id="capacityInput"   type="number" placeholder="정원" style="width:48%" />    
    <div class="button-group">    
      <button onclick="saveLesson()">저장</button>    
      <button onclick="deleteLesson()">삭제</button>    
    </div>    
  </div>    <!-- 스크립트 -->    <script>    
    let currentCell = null,    
        scheduleStart = 6,    
        scheduleEnd   = 22
    let  overlay
// 햄버거 토글    
document.getElementById('hamburger').onclick = () => {    
  document.getElementById('sidebar').classList.toggle('active');    
  overlay.style.display = document.getElementById('sidebar').classList.contains('active') ? 'block' : 'none';    
};    

// 오버레이 클릭    
overlay.onclick = () => {    
  document.getElementById('sidebar').classList.remove('active');    
  closePopup();    
};    

// 로그아웃    
document.getElementById('btnLogout').onclick = () => {    
  alert('로그아웃되었습니다!');    
  location.href = '/login.html';    
};    

    document.addEventListener('DOMContentLoaded', init);  
    const overlay = document.getElementById('overlay');
    
function init(){    
  buildCurr();    
  buildNext();    
  buildLast();    
  loadCurr();    
  highlightToday();    
  updateToday();    
  initTimeLine();    
  setInterval(updateTimeLine,60000);    

  let overlay;
  // 전체 범위 팝업: 헤더 클릭    
  document.getElementById('headerCurr').onclick = openRangePopup; 
  
}    

// --- 이번 주 테이블 생성 ---    
function buildCurr(){    
  const tb = document.querySelector('#scheduleTableCurr tbody');    
  tb.innerHTML = '';    
  for(let h=scheduleStart; h<scheduleEnd; h++){    
    const r = document.createElement('tr');    
    // 왼쪽 시간 칸 (분 팝업)    
    const c0 = document.createElement('td');    
    c0.textContent = `${h}:00`;    
    c0.className   = 'time-cell';    
    c0.onclick     = () => openMinute(c0);    
    r.append(c0);    
    // 7일 칸    
    for(let i=0; i<7; i++){    
      const c = document.createElement('td');    
      c.onclick = () => openLesson(c);    
      r.append(c);    
    }    
    tb.append(r);    
  }    
}    

// 다음/지난 주 테이블    
function buildNext(){    
  const tb = document.querySelector('#scheduleTableNext tbody');    
  tb.innerHTML = '';    
  for(let h=scheduleStart; h<scheduleEnd; h++){    
    const r = document.createElement('tr');    
    const c0 = document.createElement('td');    
    c0.textContent = `${h}:00`;    
    r.append(c0);    
    for(let i=0; i<7; i++) r.append(document.createElement('td'));    
    tb.append(r);    
  }    
}    
function buildLast(){    
  const tb = document.querySelector('#scheduleTableLast tbody');    
  tb.innerHTML = '';    
  for(let h=scheduleStart; h<scheduleEnd; h++){    
    const r = document.createElement('tr');    
    const c0 = document.createElement('td');    
    c0.textContent = `${h}:00`;    
    r.append(c0);    
    for(let i=0; i<7; i++) r.append(document.createElement('td'));    
    tb.append(r);    
  }    
}    

// 전체 범위 팝업    
function openRangePopup(){    
  document.getElementById('popupRange').style.display = 'block';    
  overlay.style.display = 'block';    
}    
function applyRangeCurr(){    
  const s = +document.getElementById('rangeStart').value.split(':')[0];    
  const e = +document.getElementById('rangeEnd').value.split(':')[0];    
  scheduleStart = s;    
  scheduleEnd   = e;    
  buildCurr(); buildNext(); buildLast();    
  loadCurr(); highlightToday(); updateToday(); initTimeLine();    
  closePopup();    
}    

// 분 팝업    
function openMinute(cell){    
  currentCell = cell;    
  document.getElementById('popupMinute').style.display = 'block';    
  overlay.style.display = 'block';    
}    
function saveMinute(){    
  const m = document.getElementById('minuteSelect').value;    
  const h = currentCell.textContent.split(':')[0];    
  currentCell.textContent = `${h}:${m}`;    
  updateTimeLine();    
  closePopup();    
}    

// 레슨 팝업    
function openLesson(cell){    
  currentCell = cell;    
  const d = cell.dataset.info ? JSON.parse(cell.dataset.info) : {};    
  document.getElementById('nameInput').value     = d.name||'';    
  document.getElementById('enrolledInput').value = d.enrolled||'';    
  document.getElementById('capacityInput').value = d.cap||'';    
  document.getElementById('popupLesson').style.display = 'block';    
  overlay.style.display = 'block';    
}    
function saveLesson(){    
  const name     = document.getElementById('nameInput').value;    
  const enrolled = +document.getElementById('enrolledInput').value||0;    
  const cap      = +document.getElementById('capacityInput').value||0;    
  const time     = currentCell.parentElement.firstChild.textContent;    
  const di       = currentCell.cellIndex;    
  const i = { name, enrolled, cap, time, di };    
  currentCell.textContent      = `${time}\n${name} (${enrolled}/${cap})`;    
  currentCell.dataset.info     = JSON.stringify(i);    
  let arr = JSON.parse(localStorage.getItem('scheduleData')||'[]');    
  arr = arr.filter(x => !(x.time===i.time && x.di===i.di));    
  arr.push(i);    
  localStorage.setItem('scheduleData', JSON.stringify(arr));    
  updateToday();    
  updateTimeLine();    
  closePopup();    
}    
function deleteLesson(){    
  if(!currentCell) return;    
  const info = currentCell.dataset.info ? JSON.parse(currentCell.dataset.info) : null;    
  if(info){    
    let data = JSON.parse(localStorage.getItem('scheduleData')||'[]');    
    data = data.filter(x => !(x.time===info.time && x.di===info.di));    
    localStorage.setItem('scheduleData', JSON.stringify(data));    
  }    
  currentCell.innerHTML = '';    
  delete currentCell.dataset.info;    
  updateToday();    
  updateTimeLine();    
  closePopup();    
}    

// 팝업 닫기    
function closePopup(){    
  document.querySelectorAll('.popup').forEach(p=>p.style.display='none');    
  overlay.style.display = 'none';    
}    

// 저장된 스케줄 로드    
function loadCurr(){    
  const data = JSON.parse(localStorage.getItem('scheduleData')||'[]');    
  data.forEach(i=>{    
    document.querySelectorAll('#scheduleTableCurr tbody tr').forEach(r=>{    
      if(r.firstChild.textContent===i.time){    
        const c = r.children[i.di];    
        c.textContent      = `${i.time}\n${i.name} (${i.enrolled}/${i.cap})`;    
        c.dataset.info     = JSON.stringify(i);    
      }    
    });    
  });    
}    

// 오늘 레슨 리스트    
function updateToday(){    
  const now = new Date();    
  const nv  = now.getHours()*60 + now.getMinutes();    
  const list = [];    
  document.querySelectorAll('#scheduleTableCurr td').forEach(c=>{    
    if(c.dataset.info){    
      const v = JSON.parse(c.dataset.info);    
      const [h,m] = v.time.split(':').map(Number);    
      const t = h*60 + m;    
      if(t>=nv) list.push({t, text:`${v.time} ${v.name} (${v.enrolled}/${v.cap})`});    
    }    
  });    
  list.sort((a,b)=>a.t-b.t);    
  const ul = document.getElementById('todayLessonList');    
  ul.innerHTML = '';    
  list.slice(0,2).forEach(i=>{    
    const li = document.createElement('li');    
    li.textContent = i.text;    
    ul.append(li);    
  });    
}    

// 시간선    
function initTimeLine(){ updateTimeLine(); }    
function updateTimeLine(){    
  document.querySelectorAll('.current-time-line').forEach(e=>e.remove());    
  const now = new Date();    
  const di  = now.getDay();    
  const nv  = now.getHours()*60 + now.getMinutes();    
  document.querySelectorAll('#scheduleTableCurr tbody tr').forEach(r=>{    
    const [hh,mm] = r.firstChild.textContent.split(':').map(Number);    
    const rowTime = hh*60 + (mm||0);    
    const next    = rowTime + 60;    
    if(nv>=rowTime && nv<next){    
      const pct = ((nv-rowTime)/60)*100;    
      const line = document.createElement('div');    
      line.className = 'current-time-line';    
      line.style.top = `${pct}%`;    
      r.children[di].appendChild(line);    
    }    
  });    
}    

// 오늘 열 강조    
function highlightToday(){    
  const di = new Date().getDay();    
  const ths = document.querySelectorAll('#scheduleTableCurr th');    
  const idx = di + 1; // 첫 칸은 시간 헤더    
  if(ths[idx]){    
    ths[idx].style.backgroundColor = '#d4af37';    
    ths[idx].style.color = '#0d1b2a';    
  }    
}

  </script>   
</body>    
</html>  
