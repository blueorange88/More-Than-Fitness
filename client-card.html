<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>고객 카드 – 바인더 서류철 (롱프레스 오픈)</title>
<style>
  :root{
    /* 사이즈/레이아웃 */
    --binder-w: 240px;         /* 바인더 너비(모바일은 아래 미디어쿼리에서 줄임) */
    --binder-overlap: -120px;  /* 겹침 정도(음수일수록 많이 겹침) */
    --shelf-pad: 22px;

    /* 색상 */
    --navy:#0B1E3A; --gold:#C8A848; --ink:#0b1220; --muted:#6b7280;
    --line:#e5e7eb; --danger:#ef4444; --ok:#2563eb; --grid:#e5e7eb;

    --shelf:#f3f4f6; --shelf-edge:#e5e7eb;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(#fff,#fbfbfb); color:var(--ink);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;
    -webkit-tap-highlight-color: transparent;
  }

  /* ===== Header ===== */
  header{ position:sticky; top:0; z-index:10; background:linear-gradient(#fff,#f9fafb);
          border-bottom:2px solid var(--gold); padding:12px 16px }
  header h1{ margin:0; font-size:18px; color:var(--navy) }

  /* ===== Shelf ===== */
  .shelf-wrap{ position:relative; padding:10px 0 20px }
  .shelf{
    position:relative; display:flex; gap:0;
    padding: 20px var(--shelf-pad) 34px;
    overflow-x:auto; overflow-y:visible; scrollbar-width:thin;
    border-top:1px solid var(--shelf-edge); border-bottom:1px solid var(--shelf-edge);
    background:var(--shelf); scroll-snap-type:x proximity;
    perspective:1200px;
  }
  .shelf::before,.shelf::after{
    content:""; position:sticky; width:40px; flex:0 0 40px; height:100%; pointer-events:none;
  }
  .shelf::before{ left:0; background:linear-gradient(90deg,#f9fafb,rgba(249,250,251,0)); }
  .shelf::after{ right:0; background:linear-gradient(270deg,#f9fafb,rgba(249,250,251,0)); }

  /* ===== Binder card ===== */
  .binder{
    position:relative; width:var(--binder-w); aspect-ratio:210/297;  /* A4비율 */
    margin-left:var(--binder-overlap);
    border-radius:16px; cursor:pointer; user-select:none; outline:0;
    transform: translateZ(0) rotateY(-10deg) translateY(6px);
    transform-origin:left center; will-change:transform, filter;
    box-shadow:-8px 0 0 rgba(0,0,0,.06) inset, 0 8px 20px rgba(0,0,0,.10);
    transition: transform .28s cubic-bezier(.2,.8,.2,1), box-shadow .28s, filter .28s, z-index .28s;
    border:1px solid rgba(0,0,0,.06); color:#0b1220;
    scroll-snap-align:start;
    touch-action: manipulation;
  }
  .binder:first-child{ margin-left:8px; }
  .binder:hover, .binder.peek{
    z-index:5; transform:translateY(-12px) rotateY(-2deg) scale(1.04);
    box-shadow:-10px 0 0 rgba(255,255,255,.18) inset, 0 22px 40px rgba(0,0,0,.18);
  }

  /* 배경(성별/연령 등급별) */
  .cFemale  { background:linear-gradient(160deg,#a7f3d0,#34d399,#059669);} /* 연두 */
  .cMale    { background:linear-gradient(160deg,#bfdbfe,#60a5fa,#2563eb);} /* 하늘 */
  .cMale50  { background:linear-gradient(160deg,#1e293b,#0f172a,#0b1e3a);} /* 네이비 */
  .cFemale50{ background:linear-gradient(160deg,#fbcfe8,#f472b6,#db2777);} /* 분홍 */
  .cDefault { background:linear-gradient(160deg,#ddd6fe,#a78bfa,#7c3aed);} /* 보라 */

  /* 왼쪽 인덱스 탭 */
  .idx-tab{
    position:absolute; left:-14px; top:16px; width:46px; height:68%;
    background:rgba(255,255,255,.85); border:1px solid rgba(0,0,0,.08);
    border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,.12);
    display:flex; align-items:center; justify-content:center; padding:6px;
    writing-mode:vertical-rl; text-orientation:upright; font-weight:900; letter-spacing:2px;
    color:#111827;
  }

  /* 하단 "최근등록" 칩 */
  .recent-chip{
    position:absolute; left:14px; bottom:10px;
    background:rgba(255,255,255,.9); color:#111827; border:1px solid rgba(0,0,0,.08);
    font-size:12px; padding:6px 10px; border-radius:12px; font-weight:800;
  }

  /* 안쪽 장식(구멍/스티커) */
  .holes{ position:absolute; left:16%; top:16%; bottom:14%; width:14px;
          display:grid; grid-template-rows:repeat(3,1fr); align-content:space-between; gap:16%;}
  .holes i{ display:block; width:12px; height:12px; border-radius:9999px; background:rgba(0,0,0,.16); }

  /* ===== Overlay(바인더가 앞으로 튀어나와 열림) ===== */
  .overlay{ position:fixed; inset:0; background:rgba(0,0,0,.50);
            display:none; align-items:center; justify-content:center; z-index:40; }
  .overlay.show{ display:flex; }

  .file-visual{
    width:min(92vw, 980px); aspect-ratio:210/297; position:relative;
    transform: translateY(20px) scale(.96); opacity:0;
    transition: transform .28s, opacity .28s; will-change:transform,opacity;
  }
  .overlay.show .file-visual{ transform: translateY(0) scale(1); opacity:1; }

  .fv-folder{
    position:absolute; inset:0; border-radius:14px; background:#e5eefc;
    box-shadow:0 18px 48px rgba(0,0,0,.35);
    overflow:hidden; transform-style:preserve-3d;
  }

  /* 덮개: 오른쪽 → 왼쪽으로 열림 */
  .fv-cover{
    position:absolute; inset:0; background:linear-gradient(135deg,#f4f1de 0%, #e9c46a 100%);
    border-left:1px solid rgba(0,0,0,.08);
    transform-origin:left center; z-index:20;
    transition: transform .6s cubic-bezier(.2,.8,.2,1);
  }
  .file-visual.open .fv-cover{ transform: translateX(-82%) rotateY(-18deg); }

  /* 종이 더미 */
  .fv-paper{ position:absolute; inset:10px 12px; z-index:8; pointer-events:none; }
  .fv-sheet{ position:absolute; inset:0; border-radius:8px; background:white; border:1px solid #e5e7eb;
             box-shadow:0 1px 3px rgba(0,0,0,.08); }
  .fv-sheet:nth-child(1){ transform: translateX(2px); }
  .fv-sheet:nth-child(2){ transform: translateX(4px); }
  .fv-sheet:nth-child(3){ transform: translateX(6px); }
  .fv-sheet:nth-child(4){ transform: translateX(8px); }

  /* 실제 컨텐츠 페이지 */
  .fv-page{
    position:absolute; inset:12px; z-index:12;
    border-radius:10px; background:#fff; border:1px solid #e5e7eb;
    box-shadow:0 1px 2px rgba(0,0,0,.06) inset;
    opacity:0; transform:translateY(6px);
    transition:opacity .3s .15s, transform .3s .15s;
  }
  .file-visual.open .fv-page{ opacity:1; transform:translateY(0); }

  .page-scroll{ position:absolute; inset:12px; overflow:auto; }

  /* 페이지 안의 그리드(좌우 스크롤 허용을 위해 최소 너비) */
  .doc-grid{
    display:grid; grid-template-columns: 1fr 1fr; gap:12px; min-width: 720px;
  }

  .card{ background:#fff; border:1px solid var(--grid); border-radius:12px; padding:12px;
         box-shadow:0 2px 8px rgba(0,0,0,.08); }
  .card h3{ margin:0 0 8px; font-size:14px }
  .row{ display:flex; gap:8px; font-size:13px; margin:4px 0 }
  .row .label{ width:68px; color:#475569; font-weight:700 }
  .pill{ display:inline-block; border:1px solid #d1d5db; background:#f9fafb; border-radius:999px; padding:6px 10px; font-size:12px; }
  .btn{ display:inline-flex; align-items:center; justify-content:center;
        border-radius:999px; padding:10px 14px; border:1px solid #d1d5db; cursor:pointer; background:#fff; }
  .btn.primary{ background:var(--navy); color:#fff; border-color:var(--navy); }

  /* 닫기 버튼 */
  .closebar{ position:absolute; left:12px; top:10px; z-index:30; display:flex; gap:8px; align-items:center; }
  .closebtn{ background:#fff; border:1px solid #d1d5db; border-radius:999px; padding:8px 12px; font-weight:800; cursor:pointer }

  /* 반응형 */
  @media (max-width: 860px){
    :root{ --binder-w: 200px; --binder-overlap: -90px; }
  }
  @media (max-width: 540px){
    :root{ --binder-w: 170px; --binder-overlap: -70px; }
    .doc-grid{ min-width: 640px; }  /* 모바일에서도 좌우 스크롤 가능 */
  }

  /* 다크 느낌 */
  @media (prefers-color-scheme: dark){
    body{ background:linear-gradient(#0b1220,#101826); color:#e5e7eb; }
    header{ background:linear-gradient(#0f172a,#0b1220); border-bottom-color:#475569; }
    .shelf{ background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.02));
            border-top-color:#374151; border-bottom-color:#374151; }
    .binder{ color:#eef2ff; border-color:rgba(255,255,255,.06);
             box-shadow:-8px 0 0 rgba(0,0,0,.45) inset, 0 12px 28px rgba(0,0,0,.65); }
    .fv-folder{ background:#0f172a; }
    .fv-page{ background:#0b1220; border-color:#303644; }
    .card{ background:#0f172a; border-color:#303644; }
    .btn{ background:#0f172a; color:#e5e7eb; border-color:#303644; }
    .btn.primary{ background:#0B1E3A; border-color:#0B1E3A; }
    .idx-tab{ background:rgba(255,255,255,.14); color:#e5e7eb; border-color:rgba(255,255,255,.2) }
    .recent-chip{ background:rgba(255,255,255,.14); color:#e5e7eb; border-color:rgba(255,255,255,.2) }
  }
</style>
</head>
<body>
  <header><h1>개인 트레이닝 – 바인더 서류철</h1></header>

  <section class="shelf-wrap">
    <div id="shelf" class="shelf" aria-live="polite"></div>
  </section>

  <!-- ===== Overlay (파일이 화면 앞으로 나오고 덮개가 열림) ===== -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true">
    <div class="file-visual" id="fileVisual">
      <div class="closebar">
        <button class="closebtn" id="btnClose">닫기</button>
        <strong id="ovrTitle" style="font-size:14px"></strong>
      </div>

      <div class="fv-folder">
        <!-- 종이 더미 -->
        <div class="fv-paper">
          <div class="fv-sheet"></div>
          <div class="fv-sheet"></div>
          <div class="fv-sheet"></div>
          <div class="fv-sheet"></div>
        </div>

        <!-- 실제 페이지 -->
        <div class="fv-page">
          <div class="page-scroll">
            <div id="fileBody" class="doc-grid"></div>
          </div>
        </div>

        <!-- 덮개 -->
        <div class="fv-cover"></div>
      </div>
    </div>
  </div>

<script>
/* ===== Mock members (데모) ===== */
const members = [
  { id:'001', name:'김민수', grade:'VIP', trainer:'A', gender:'male', birthYear:1989, recent:'2025-09-05',
    first:'2024-01-15', expireAt:'', lastLog:'2025-09-01', remaining:8, total:10, next:'-', note:'팔꿈치 통증 주의' },
  { id:'002', name:'이영희', grade:'일반', trainer:'B', gender:'female', birthYear:1997, recent:'2025-09-04',
    first:'2023-11-20', expireAt:'', lastLog:'2025-09-03', remaining:44, total:50, next:'-', note:'' },
  { id:'003', name:'손경남', grade:'VIP', trainer:'A', gender:'male', birthYear:1972, recent:'2025-09-06',
    first:'2024-03-02', expireAt:'', lastLog:'2025-09-02', remaining:10, total:10, next:'-', note:'체형교정' },
  { id:'004', name:'이선주', grade:'일반', trainer:'C', gender:'female', birthYear:1999, recent:'2025-09-02',
    first:'2025-05-04', expireAt:'', lastLog:'2025-09-02', remaining:0, total:0, next:'-', note:'' },
  { id:'005', name:'황형민', grade:'VIP', trainer:'A', gender:'male', birthYear:1974, recent:'2025-09-05',
    first:'2024-12-01', expireAt:'', lastLog:'2025-09-05', remaining:19, total:20, next:'-', note:'무릎 재활' },
];

const shelf = document.getElementById('shelf');
const overlay = document.getElementById('overlay');
const fileVisual = document.getElementById('fileVisual');
const fileBody = document.getElementById('fileBody');
const ovrTitle = document.getElementById('ovrTitle');

function colorClass(m){
  const now = new Date().getFullYear();
  const age = m.birthYear ? now - m.birthYear : null;
  if(m.gender==='female') return (age!==null && age>=50)?'cFemale50':'cFemale';
  if(m.gender==='male') return (age!==null && age>=50)?'cMale50':'cMale';
  return 'cDefault';
}
function escapeHtml(s){ return String(s??'').replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;' }[m])); }

function renderShelf(){
  shelf.innerHTML='';
  members.forEach((m, idx)=>{
    const art = document.createElement('article');
    art.className = `binder ${colorClass(m)}`;
    art.setAttribute('role','button');
    art.setAttribute('aria-label', `${m.name} 고객 카드`);
    art.innerHTML = `
      <div class="idx-tab">${escapeHtml(m.name)}</div>
      <div class="holes"><i></i><i></i><i></i></div>
      <span class="recent-chip">최근등록 ${escapeHtml(m.recent||'-')}</span>
    `;

    // 짧은 클릭 → 피크 토글
    art.addEventListener('click', ()=>{
      if (art._longFired){ art._longFired=false; return; }
      // 다른 카드 피크 해제
      document.querySelectorAll('.binder.peek').forEach(b=>b.classList.remove('peek'));
      art.classList.toggle('peek');
      // 좌우 스크롤 보이도록 스크롤 스냅
      art.scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'});
    });

    // 롱프레스 → 전체 열기
    let timer=null;
    const longPressMs = 600;
    const startLP = (ev)=>{
      if(timer) clearTimeout(timer);
      art._longFired = false;
      timer = setTimeout(()=>{
        art._longFired = true;
        openOverlay(m);
      }, longPressMs);
    };
    const cancelLP = ()=>{
      if(timer){ clearTimeout(timer); timer=null; }
    };
    art.addEventListener('pointerdown', startLP, {passive:true});
    ['pointerup','pointerleave','pointercancel'].forEach(ev=> art.addEventListener(ev, cancelLP, {passive:true}));

    shelf.appendChild(art);
  });
}

function openOverlay(member){
  // 제목
  ovrTitle.textContent = `${member.name} · ${member.grade||'-'}`;

  // 페이지 안 컨텐츠 구성(기존 내용 그대로 붙여넣어도 됨)
  fileBody.innerHTML = `
    <div class="card">
      <h3>고객정보</h3>
      <div class="row"><span class="label">이름</span><span>${escapeHtml(member.name)}</span></div>
      <div class="row"><span class="label">담당</span><span>${escapeHtml(member.trainer||'-')}</span></div>
      <div class="row"><span class="label">등급</span><span>${escapeHtml(member.grade||'-')}</span></div>
      <div class="row"><span class="label">최근등록</span><span>${escapeHtml(member.recent||'-')}</span></div>
      <div class="row"><span class="label">만료일</span><span>${escapeHtml(member.expireAt||'-')}</span></div>
      <div class="row"><span class="label">작성</span><span>${escapeHtml(member.logCount||0)}회</span></div>
      <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap">
        <span class="pill">잔여 <strong>${member.remaining||0}</strong></span>
        <span class="pill">총 <strong>${member.total||0}</strong></span>
      </div>
    </div>

    <div class="card">
      <h3>안내 / 액션</h3>
      <p style="margin:0 0 10px; color:#475569; font-size:13px">바인더는 롱프레스로 열 수 있어요. 페이지가 좁으면 좌우 스크롤로 더 볼 수 있습니다.</p>
      <div style="display:flex; gap:8px; flex-wrap:wrap">
        <button class="btn" onclick="alert('일지 열기: ${escapeHtml(member.name)}')">📓 일지 열기</button>
        <button class="btn" onclick="alert('연장 등록: ${escapeHtml(member.name)}')">➕ 연장 등록</button>
        <button class="btn primary" onclick="alert('–1 소진 처리')">–1 소진</button>
      </div>
      ${member.note?`<div style="margin-top:10px; font-size:13px; color:#7c5200; background:#fff8e1; border:1px solid #f59e0b; padding:8px; border-radius:10px">📎 메모: ${escapeHtml(member.note)}</div>`:''}
    </div>
  `;

  // 오버레이 표시 + 덮개 오픈
  overlay.classList.add('show');
  // 덮개 애니메이션은 소량의 지연 후
  requestAnimationFrame(()=> fileVisual.classList.add('open'));
}

function closeOverlay(){
  fileVisual.classList.remove('open');
  setTimeout(()=> overlay.classList.remove('show'), 220);
}

// 닫기 버튼/바깥 클릭
document.getElementById('btnClose').addEventListener('click', closeOverlay);
overlay.addEventListener('click', (e)=>{ if(e.target===overlay) closeOverlay(); });

renderShelf();
</script>
</body>
</html>
