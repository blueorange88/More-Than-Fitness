<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>레슨 고객 – 파일 스택</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  /* ====== 스택/파일 기본 ====== */
  .file-zone{ perspective:1400px; transform-style:preserve-3d; height:320px; }
  .pf{ position:absolute; width:120px; height:160px; transform-origin:center bottom;
       transition:all .8s cubic-bezier(.175,.885,.32,1.275); cursor:pointer; }
  .pf:nth-child(1){ transform:translateX(-150px) rotate(-15deg); z-index:1; }
  .pf:nth-child(2){ transform:translateX(-90px)  rotate(-9deg);  z-index:2; }
  .pf:nth-child(3){ transform:translateX(-30px)  rotate(-3deg);  z-index:3; }
  .pf:nth-child(4){ transform:translateX(30px)   rotate(3deg);   z-index:4; }
  .pf:nth-child(5){ transform:translateX(90px)   rotate(9deg);   z-index:5; }
  .pf:nth-child(6){ transform:translateX(150px)  rotate(15deg);  z-index:6; }

  .pf:hover:not(.opened){ transform:translateY(-8px) !important; }
  .pf.opened{ transform:translateY(-50px) translateZ(50px) scale(1.28) rotate(0deg)!important; z-index:100!important; }
  .pf.fully{  transform:translateY(-120px) translateZ(120px) scaleX(5) scaleY(2.6) rotate(0deg)!important; z-index:200!important; }

  .folder{ position:relative; height:100%; border-radius:8px; overflow:hidden;
           background:linear-gradient(135deg,#8b5a2b 0%,#a0692e 100%); border:2px solid #6d4423;
           box-shadow:0 4px 12px rgba(0,0,0,.15); transition:box-shadow .6s ease; }
  .pf:hover:not(.opened) .folder{ box-shadow:0 6px 16px rgba(0,0,0,.2); }

  .cover{ position:absolute; inset:0; width:100%; border-radius:0 6px 6px 0;
          transform-origin:left center; z-index:20;
          background:linear-gradient(135deg,#f4f1de 0%,#e9c46a 100%); border-left:2px solid #d4a574;
          transition:transform .8s cubic-bezier(.175,.885,.32,1.275), box-shadow .6s ease;
          box-shadow:-2px 0 8px rgba(0,0,0,.1); }
  .pf.opened .cover{ transform:translateX(-30%) rotateY(-6deg); }
  .pf.fully  .cover{ transform:translateX(-82%) rotateY(-18deg); }

  .tab{ position:absolute; top:14px; left:-14px; width:40px; height:22px;
        border-radius:8px 8px 0 0; display:flex; align-items:center; justify-content:center;
        background:linear-gradient(135deg,#d4a574,#c19660); border:2px solid #a0692e;
        font-weight:800; font-size:10px; color:#6d4423; transform:rotate(-5deg); z-index:30; }

  .papers{ position:absolute; inset:8px; pointer-events:none; z-index:10; }
  .paper{ position:absolute; inset:0; background:#fff; border:1px solid #e5e5e5; border-radius:4px;
          box-shadow:0 1px 3px rgba(0,0,0,.1); transition:transform .6s ease; transform-origin:left center; }
  .paper:nth-child(1){ transform:translateX(1px) }
  .paper:nth-child(2){ transform:translateX(2px) }
  .paper:nth-child(3){ transform:translateX(3px) }
  .paper:nth-child(4){ transform:translateX(4px) }
  .pf.opened .paper:nth-child(1){ transform:translateX(-3px) rotateY(3deg) }
  .pf.opened .paper:nth-child(2){ transform:translateX(-2px) rotateY(2deg) }
  .pf.opened .paper:nth-child(3){ transform:translateX(-1px) rotateY(1deg) }

  .peek{ position:absolute; inset:0 70% 0 0; z-index:15; padding:8px; border-right:2px solid #e5e5e5;
         background:#fff; border-radius:6px 0 0 6px; opacity:0; transition:opacity .45s ease; }
  .pf.opened .peek{ opacity:1 }
  .full{ position:absolute; inset:0; z-index:25; display:flex; gap:6px; opacity:0; transition:opacity .45s ease; }
  .pf.fully .full{ opacity:1 } .pf.fully .peek{ opacity:0 }

  .page{ flex:1; background:#fff; border:2px solid #e5e5e5; border-radius:6px; padding:6px;
         box-shadow:0 4px 12px rgba(0,0,0,.15); font-size:10px; }
  .page.left{ transform:rotateY(3deg) translateX(-2px) }
  .page.right{transform:rotateY(-3deg) translateX(2px) }

  .shadow{ position:absolute; left:10%; right:10%; bottom:-10px; height:16px;
           background:radial-gradient(ellipse,rgba(0,0,0,.22) 0%,transparent 70%) }
  .pf.opened .shadow{ transform:scale(1.25); opacity:.5 }

  /* 모바일 사이즈 보정 */
  @media (max-width:640px){
    .pf{ width:104px; height:140px }
    .pf:nth-child(1){ transform:translateX(-120px) rotate(-15deg) }
    .pf:nth-child(2){ transform:translateX(-72px)  rotate(-9deg)  }
    .pf:nth-child(3){ transform:translateX(-24px)  rotate(-3deg)  }
    .pf:nth-child(4){ transform:translateX(24px)   rotate(3deg)   }
    .pf:nth-child(5){ transform:translateX(72px)   rotate(9deg)   }
    .pf:nth-child(6){ transform:translateX(120px)  rotate(15deg)  }
    .tab{ width:36px; height:20px; font-size:9px; left:-12px }
  }
</style>
</head>
<body class="bg-gradient-to-br from-slate-100 via-blue-50 to-indigo-100 min-h-screen p-4">
  <div class="max-w-6xl mx-auto">
    <h1 class="text-2xl font-bold text-slate-800 text-center">레슨 고객 파일</h1>
    <p class="text-center text-slate-600 text-sm mb-6">한 번 탭 = 미리열기 · 두 번 탭/더블클릭 = 완전열기</p>

    <!-- 파일 스택 -->
    <div id="stack" class="file-zone relative flex items-center justify-center"></div>

    <!-- 하단 상세 -->
    <div id="panel" class="mt-10 bg-white rounded-2xl shadow-xl p-6 opacity-0 translate-y-4 transition">
      <div class="text-center text-slate-500">
        <div class="text-4xl mb-2">📁</div>
        <b>고객 파일을 선택하세요</b>
      </div>
    </div>
  </div>

<script>
/* ================= 데이터(예시) ================= */
const data = [
  { tab:'김민수',  icon:'🎹', title:'김민수 고객님',  lesson:'피아노',  status:'진행중',
    info:{ start:'2024.01.15', when:'화 19:00', level:'중급', fee:'12만원' },
    detail:{ age:35, phone:'010-1234-5678', addr:'서울 강남', job:'회사원',
             progress:'8/12', attend:'95%', now:'쇼팽 녹턴', goal:'발표회' } },
  { tab:'이영희',  icon:'🎸', title:'이영희 고객님',  lesson:'기타',    status:'진행중',
    info:{ start:'2023.11.20', when:'목 18:00', level:'초급', fee:'10만원' },
    detail:{ age:28, phone:'010-2345-6789', addr:'서울 서초', job:'디자이너',
             progress:'16/20', attend:'88%', now:'Hotel California', goal:'핑거피킹' } },
  { tab:'박철수',  icon:'🥁', title:'박철수 고객님',  lesson:'드럼',    status:'휴강',
    info:{ start:'2024.02.01', when:'금 20:00', level:'고급', fee:'15만원' },
    detail:{ age:42, phone:'010-3456-7890', addr:'경기 성남', job:'엔지니어',
             progress:'6/8', attend:'100%', now:'In The Air', goal:'더블베이스' } },
  { tab:'최지은',  icon:'🎤', title:'최지은 고객님',  lesson:'보컬',    status:'진행중',
    info:{ start:'2024.03.10', when:'수 19:00', level:'중급', fee:'13만원' },
    detail:{ age:24, phone:'010-4567-8901', addr:'서울 마포', job:'대학생',
             progress:'4/6', attend:'92%', now:'좋은 날', goal:'고음 안정화' } },
  { tab:'정우진',  icon:'🎻', title:'정우진 고객님',  lesson:'바이올린', status:'체험',
    info:{ start:'2024.04.05', when:'토 14:00', level:'초급', fee:'14만원' },
    detail:{ age:19, phone:'010-5678-9012', addr:'서울 영등포', job:'학생',
             progress:'1/1', attend:'100%', now:'기초 스케일', goal:'자세' } },
  { tab:'한소영',  icon:'🎺', title:'한소영 고객님',  lesson:'색소폰',  status:'진행중',
    info:{ start:'2023.09.15', when:'월 20:00', level:'고급', fee:'16만원' },
    detail:{ age:38, phone:'010-6789-0123', addr:'서울 종로', job:'변호사',
             progress:'26/28', attend:'96%', now:'Take Five', goal:'즉흥' } },
];

const $ = (s, el=document) => el.querySelector(s);
const stack = $('#stack');
const panel = $('#panel');
let opened = null;

/* ============ 렌더 ============ */
function cardTpl(m){
  return `
  <div class="folder">
    <div class="tab">${m.tab}</div>
    <div class="cover"><span class="absolute top-1 right-1 text-[10px] px-1.5 py-0.5 rounded bg-white/80 border border-black/10">${m.status}</span></div>
    <div class="papers">
      <div class="paper"></div><div class="paper"></div><div class="paper"></div><div class="paper"></div>
    </div>

    <!-- 미리보기 -->
    <div class="peek">
      <div class="text-center text-[10px] leading-tight">
        <div class="text-xl mb-1">${m.icon}</div>
        <b class="text-slate-800">${m.title}</b>
        <div class="text-slate-500 mt-1">
          <div>📅 ${m.info.start}</div>
          <div>⏰ ${m.info.when}</div>
          <div>📚 ${m.info.level} · 💰 ${m.info.fee}</div>
        </div>
      </div>
    </div>

    <!-- 완전열기(양쪽 페이지) -->
    <div class="full">
      <div class="page left">
        <div class="text-center mb-1">
          <div class="text-lg">${m.icon}</div>
          <div class="w-8 h-10 bg-slate-200 rounded mx-auto my-1 flex items-center justify-center text-[10px] text-slate-500">사진</div>
          <b class="text-[11px]">${m.title}</b>
        </div>
        <div class="text-[11px] space-y-0.5">
          <div><b>나이:</b> ${m.detail.age}</div>
          <div><b>연락처:</b> ${m.detail.phone}</div>
          <div><b>주소:</b> ${m.detail.addr}</div>
          <div><b>직업:</b> ${m.detail.job}</div>
          <div><b>시작일:</b> ${m.info.start}</div>
        </div>
      </div>
      <div class="page right">
        <b class="text-[12px]">🎵 레슨 현황</b>
        <div class="text-[11px] space-y-0.5 mt-0.5">
          <div><b>진도:</b> ${m.detail.progress}</div>
          <div><b>출석률:</b> ${m.detail.attend}</div>
          <div><b>현재곡:</b> ${m.detail.now}</div>
          <div><b>목표:</b> ${m.detail.goal}</div>
        </div>
      </div>
    </div>
  </div>
  <div class="shadow"></div>
  `;
}

data.forEach((m,i)=>{
  const el = document.createElement('article');
  el.className = 'pf';
  el.setAttribute('tabindex','0');
  el.setAttribute('role','button');
  el.setAttribute('aria-label', `${m.title} 파일`);
  el.innerHTML = cardTpl(m);
  stack.appendChild(el);

  attachGestures(el, i); // 제스처 바인딩
});

/* ============ 제스처: 단일탭/더블탭/더블클릭 ============ */
function attachGestures(el, idx){
  // 데스크톱: 더블클릭
  el.addEventListener('dblclick', (e)=>{ e.stopPropagation(); fullyOpen(el, idx); });

  // 키보드 접근성
  el.addEventListener('keydown', (e)=>{
    if(e.key==='Enter' || e.key===' '){ e.preventDefault(); toggleOpen(el, idx); }
  });

  // 모바일 더블탭 감지기
  let lastTap=0, moved=false, sx=0, sy=0, longTimer=null;
  el.addEventListener('pointerdown', (ev)=>{ sx=ev.clientX; sy=ev.clientY; moved=false;
    longTimer=setTimeout(()=>{/* 필요시 롱프레스 액션 */}, 700);
  },{passive:true});
  el.addEventListener('pointermove', (ev)=>{ if(Math.hypot(ev.clientX-sx, ev.clientY-sy)>14) moved=true; },{passive:true});
  el.addEventListener('pointerup', (ev)=>{
    clearTimeout(longTimer);
    if(moved) return;
    const now=Date.now();
    if(now-lastTap<300){ fullyOpen(el, idx); lastTap=0; }
    else{ open(el, idx); lastTap=now; }
  });
}

/* ============ 상태 토글 ============ */
function open(el, idx){
  [...document.querySelectorAll('.pf')].forEach(x=> x!==el && x.classList.remove('opened','fully'));
  el.classList.toggle('opened');
  el.classList.remove('fully');
  opened = el.classList.contains('opened') ? el : null;
  if(opened){ scrollIntoViewCentered(el); showPanel(idx); } else { hidePanel(); }
}
function fullyOpen(el, idx){
  [...document.querySelectorAll('.pf')].forEach(x=> x!==el && x.classList.remove('opened','fully'));
  el.classList.add('fully'); el.classList.remove('opened'); opened=el;
  hidePanel();
}
function toggleOpen(el, idx){ el.classList.contains('opened')||el.classList.contains('fully') ? open(el, idx) : open(el, idx); }

/* ============ 패널 ============ */
function showPanel(index){
  const m=data[index];
  panel.innerHTML = `
    <div class="flex items-start gap-4">
      <div class="text-5xl">${m.icon}</div>
      <div class="flex-1">
        <div class="text-xl font-bold text-slate-800">${m.title}</div>
        <div class="text-slate-600">${m.lesson} · ${m.info.when}</div>
        <div class="text-[13px] text-slate-500 mt-1">상태: ${m.status} · 시작일 ${m.info.start} · 수강료 ${m.info.fee}</div>
      </div>
    </div>
  `;
  panel.classList.remove('opacity-0','translate-y-4');
  panel.classList.add('opacity-100','translate-y-0');
}
function hidePanel(){
  panel.classList.remove('opacity-100','translate-y-0');
  panel.classList.add('opacity-0','translate-y-4');
}

/* ============ 유틸 ============ */
function scrollIntoViewCentered(el){
  el.scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'});
}
</script>
</body>
</html>
