<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>개인 트레이닝 일지 – 서류철</title>
<style>
  :root{
    /* 브랜드 컬러 */
    --navy:#0B1E3A;         /* 딥네이비 */
    --gold:#C8A848;         /* 골드 */
    --gold-d:#9E8536;       /* 골드 짙은톤 */
    --underwhite:#F7F6F2;   /* 언더화이트 */

    /* UI 보조 */
    --ink:#0b1220;
    --muted:#6b7280;
    --line:#e5e7eb;
    --card:#ffffff;
    --recent-bg: #fff8e6;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:var(--underwhite); color:var(--ink);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif
  }

  header{
    position:sticky; top:0; z-index:10;
    background:linear-gradient(#fff, var(--underwhite));
    border-bottom:2px solid var(--gold);
    padding:14px 16px 12px;
  }
  header h1{margin:0 0 10px;font-size:18px;color:var(--navy);letter-spacing:.2px}
  .tools{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  .tools input[type="search"]{
    flex:1;border:1px solid var(--line);border-radius:12px;padding:10px 12px;font-size:14px;background:#fff
  }
  .tools .select, .tools .check{
    display:flex;align-items:center;gap:8px;font-size:13px;color:var(--navy)
  }
  .tools select{
    border:1px solid var(--line);border-radius:10px;padding:8px 10px;background:#fff
  }
  .grid{
    padding:18px;display:grid;gap:16px;grid-template-columns:repeat(auto-fill,minmax(260px,1fr))
  }

  /* 서류파일 카드 */
  .file-card{
    position:relative;background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px 14px 14px;
    box-shadow:0 2px 8px rgba(0,0,0,.05); cursor:pointer; transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
    outline:0;
  }
  .file-card::before{
    content:""; position:absolute; top:-12px; left:14px; width:84px; height:18px;
    background:linear-gradient(90deg,var(--gold),var(--gold-d));
    border-radius:10px 10px 2px 2px; box-shadow:0 -1px 0 rgba(0,0,0,.04);
  }
  .file-card:hover, .file-card:focus-visible{
    transform:translateY(-2px);
    box-shadow:0 14px 28px rgba(11,30,58,.18);
    border-color:var(--gold);
  }
  /* 최근 작성 강조 바 */
  .file-card.recent::after{
    content:""; position:absolute; inset:10px auto 10px 8px; width:4px; border-radius:4px; background:var(--gold);
  }

  .file-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
  .name{font-weight:800; font-size:17px; overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:70%; color:var(--navy)}
  .badge{font-size:11px;padding:2px 8px;border-radius:999px;border:1px solid var(--gold);background:var(--recent-bg);color:#8a6d1d}

  .row {display:flex;gap:6px;align-items:center;font-size:13px;color:var(--muted);margin:3px 0}
  .row .label{width:64px;color:#334155}
  .row .value{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

  .empty{padding:40px 16px;text-align:center;color:var(--muted)}
  .footer{padding:10px 16px 18px;color:var(--muted);font-size:12px}
</style>
</head>
<body>
  <header>
    <h1>개인 트레이닝 일지 – 서류철</h1>
    <div class="tools">
      <input id="q" type="search" placeholder="회원 이름 / 연락처 / 담당 / 등급 검색" />
      <div class="select">
        정렬:
        <select id="sortBy" aria-label="정렬">
          <option value="recent" selected>최근 작성순</option>
          <option value="name">이름(가나다)</option>
          <option value="grade">등급</option>
          <option value="first">최초 등록일</option>
        </select>
      </div>
      <label class="check"><input id="onlyRecent" type="checkbox"> 최근 작성만 보기</label>
    </div>
  </header>

  <main class="grid" id="grid" aria-live="polite"></main>
  <div id="empty" class="empty" hidden>검색 결과가 없어요.</div>
  <div class="footer">Tip: 카드를 클릭하면 해당 회원의 운동일지로 이동합니다. 최근 7일 이내 작성 시 골드 배지로 표시돼요.</div>

<script>
  /* ===== 경로 설정 ===== */
  const PT_LOG_URL = "pt-log.html"; // 예: "/MTF-Fhtml/pt-log.html"

  /* ===== 샘플 데이터 (파이어베이스로 대체 가능) ===== */
  const members = [
    { id:"u1", name:"김유리",  phone:"01086468426", gender:"여성", trainer:"남", grade:"VIP", first:"2025-05-10", lastLog:"2025-09-01", logCount:12 },
    { id:"u2", name:"김현빈",  phone:"01084988853", gender:"남성", trainer:"남", grade:"VIP", first:"2025-05-12", lastLog:"2025-08-23", logCount:8  },
    { id:"u3", name:"원지완",  phone:"01084988853", gender:"남성", trainer:"남", grade:"VIP", first:"2025-05-12", lastLog:"2025-09-03", logCount:16 },
    { id:"u4", name:"이선주",  phone:"01084988853", gender:"여성", trainer:"남", grade:"VIP", first:"2025-05-12", lastLog:"2025-07-19", logCount:3  },
    { id:"u5", name:"염수정",  phone:"01084988853", gender:"여성", trainer:"남", grade:"프로모션", first:"2025-05-12", lastLog:"2025-09-04", logCount:21 },
  ];

  /* ===== 유틸 ===== */
  const grid = document.getElementById('grid');
  const empty = document.getElementById('empty');
  const q = document.getElementById('q');
  const sortSel = document.getElementById('sortBy');
  const onlyRecent = document.getElementById('onlyRecent');

  function formatPhone(raw){
    const v = String(raw||"").replace(/\D/g,'').slice(0,11);
    if (v.length<=3) return v;
    if (v.length<=7) return v.slice(0,3)+'-'+v.slice(3);
    return v.slice(0,3)+'-'+v.slice(3,7)+'-'+v.slice(7);
  }
  function escapeHtml(s){return String(s).replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;' }[m]))}
  function daysDiff(dateStr){
    const d = new Date(dateStr+'T00:00:00');
    const today = new Date(); const ms = today - d;
    return Math.floor(ms/86400000);
  }
  function isRecent(dateStr){ return !!dateStr && daysDiff(dateStr) <= 7; }

  /* ===== 렌더링 ===== */
  function render(list){
    grid.innerHTML = "";
    if (!list.length){ empty.hidden = false; return; }
    empty.hidden = true;

    list.forEach(m=>{
      const recent = isRecent(m.lastLog);
      const card = document.createElement('article');
      card.className = 'file-card' + (recent ? ' recent' : '');
      card.tabIndex = 0;
      card.setAttribute('role','button');
      card.setAttribute('aria-label', `${m.name} 일지 열기`);

      const badge = recent ? `<span class="badge">최근 작성 ${m.lastLog}</span>` : `<span class="badge" style="border-color:#e5e7eb;background:#fff">${escapeHtml(m.grade||"")}</span>`;

      card.innerHTML = `
        <div class="file-head">
          <div class="name">${escapeHtml(m.name)}</div>
          ${badge}
        </div>
        <div class="row"><span class="label">연락처</span><span class="value">${formatPhone(m.phone)}</span></div>
        <div class="row"><span class="label">성별</span><span class="value">${escapeHtml(m.gender||"")}</span></div>
        <div class="row"><span class="label">담당</span><span class="value">${escapeHtml(m.trainer||"")}</span></div>
        <div class="row"><span class="label">등록일</span><span class="value">${escapeHtml(m.first||"")}</span></div>
        <div class="row"><span class="label">작성</span><span class="value">${m.logCount||0}회</span></div>
      `;
      card.addEventListener('click', ()=>openLog(m));
      card.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' ') {e.preventDefault(); openLog(m);} });
      grid.appendChild(card);
    });
  }

  function openLog(m){
    const p = new URLSearchParams({
      id: m.id, name: m.name, phone: m.phone,
      trainer: m.trainer || '', gender: m.gender || '',
      grade: m.grade || '', first: m.first || '', lastLog: m.lastLog || ''
    });
    location.href = `${PT_LOG_URL}?${p.toString()}`;
  }

  /* ===== 검색/정렬/필터 ===== */
  function filterSort(){
    const keyword = (q.value||"").trim().toLowerCase();
    const norm = (s)=>String(s||"").toLowerCase();
    const list = members.filter(m=>{
      const phoneMatch = formatPhone(m.phone).replace(/\D/g,'').includes(keyword.replace(/\D/g,''));
      const match = !keyword || norm(m.name).includes(keyword) || phoneMatch ||
                    norm(m.trainer).includes(keyword) || norm(m.grade).includes(keyword);
      const recentOK = !onlyRecent.checked || isRecent(m.lastLog);
      return match && recentOK;
    });

    // 정렬
    const by = sortSel.value;
    list.sort((a,b)=>{
      if (by==='recent')   return (b.lastLog||'').localeCompare(a.lastLog||'');  // 최신 우선
      if (by==='name')     return a.name.localeCompare(b.name,'ko');
      if (by==='grade')    return (a.grade||'').localeCompare(b.grade||'','ko');
      if (by==='first')    return (b.first||'').localeCompare(a.first||'');      // 최근 등록 우선
      return 0;
    });

    render(list);
  }

  // init
  render(members);
  q.addEventListener('input', filterSort);
  sortSel.addEventListener('change', filterSort);
  onlyRecent.addEventListener('change', filterSort);
</script>
</body>
</html>
